<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hackthebox - Sink" /><meta property="og:locale" content="en" /><meta name="description" content="Just another hackthebox writeups website powered by poorduck" /><meta property="og:description" content="Just another hackthebox writeups website powered by poorduck" /><link rel="canonical" href="https://x00tex.github.io/posts/sink/" /><meta property="og:url" content="https://x00tex.github.io/posts/sink/" /><meta property="og:site_name" content="Poorduck" /><meta property="og:image" content="https://x00tex.github.io/assets/img/posts/sink/sink_banner.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-07T18:30:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://x00tex.github.io/assets/img/posts/sink/sink_banner.png" /><meta property="twitter:title" content="Hackthebox - Sink" /><meta name="twitter:site" content="@p00rduck" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-07T18:30:00+00:00","datePublished":"2021-09-07T18:30:00+00:00","description":"Just another hackthebox writeups website powered by poorduck","headline":"Hackthebox - Sink","image":"https://x00tex.github.io/assets/img/posts/sink/sink_banner.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://x00tex.github.io/posts/sink/"},"url":"https://x00tex.github.io/posts/sink/"}</script><title>Hackthebox - Sink | Poorduck</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Poorduck"><meta name="application-name" content="Poorduck"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/poorduck.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Poorduck</a></div><div class="site-subtitle font-italic">Kwak kwak</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/x00tex" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/p00rduck" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['x00tex-writeups.3us6n','simplelogin.co'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox - Sink</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox - Sink</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/p00rduck">p00rduck</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1631039400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-09-07 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1589 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/posts/sink/sink_banner.png" alt="" data-proofer-ignore></p><p align="right"> <a href="https://www.hackthebox.eu/home/users/profile/391067" target="_blank"><img loading="lazy" alt="x00tex" data-src="https://www.hackthebox.eu/badge/image/391067" data-proofer-ignore></a></p><h1 id="enumeration">Enumeration</h1><p><strong>IP-ADDR:</strong> 10.10.10.225 sink.htb</p><p><strong>nmap scan:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span class="o">(</span>RSA<span class="o">)</span>
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span class="o">(</span>ED25519<span class="o">)</span>
3000/tcp open  ppp?
| fingerprint-strings: 
|   GenericLines, Help: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
|     Set-Cookie: <span class="nv">lang</span><span class="o">=</span>en-US<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> Max-Age<span class="o">=</span>2147483647
|     Set-Cookie: <span class="nv">i_like_gitea</span><span class="o">=</span>b06d007546b891b1<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> HttpOnly
|     Set-Cookie: <span class="nv">_csrf</span><span class="o">=</span>g8iWus6Yg0Gy4q5O_dzZHqGWHTM6MTYyODczODc4MTA2ODg3ODgzMQ<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Fri, 13 Aug 2021 03:26:21 GMT<span class="p">;</span> HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Thu, 12 Aug 2021 03:26:21 GMT
|     &lt;<span class="o">!</span>DOCTYPE html&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en-US"</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"theme-"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head </span>data-suburl<span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1"</span><span class="o">&gt;</span>
|     &lt;meta http-equiv<span class="o">=</span><span class="s2">"x-ua-compatible"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"ie=edge"</span><span class="o">&gt;</span>
|     &lt;title&gt; Gitea: Git with a cup of tea &lt;/title&gt;
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"manifest"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/manifest.json"</span> <span class="nv">crossorigin</span><span class="o">=</span><span class="s2">"use-credentials"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"theme-color"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"#6cc644"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea - Git with a cup of tea"</span> /&gt;
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"description"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea (Git with a cup of tea) is a painless
5000/tcp open  http    Gunicorn 20.0.0
|_http-server-header: gunicorn/20.0.0
|_http-title: Sink Devops
</span></pre></table></code></div></div><ul><li>Port 3000 is running “gitea”, Identified from fingerprint-strings.<li>Port 5000 is running “gunicorn/20.0.0” server.<li>Gitea running Version: 1.12.6<li>There is no signup option in gitea.<li><p>Only interesting thing found is, user “root” contributions but can not see them</p><p><img data-src="/assets/img/posts/sink/root-contributions.png" alt="" data-proofer-ignore></p></ul><p><em>Final thing before diving is that “gunicorn” is a python http server and it cannot handle brute forcing or fuzzing.</em></p><p>Port 5000 gunicorn is server running a static webapp and have login and signup option</p><p><img data-src="/assets/img/posts/sink/gunicorn-server.png" alt="" data-proofer-ignore></p><p>Found <code class="language-plaintext highlighter-rouge">haproxy</code> is running from response header when doing sign. Also get a session cookie which is a flash auth token.</p><p><img data-src="/assets/img/posts/sink/sign-rspn-header.png" alt="" data-proofer-ignore></p><p>we can verify cookie with <a href="https://github.com/Paradoxis/Flask-Unsign"><code class="language-plaintext highlighter-rouge">flask-unsign</code></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>❯ flask-unsign <span class="nt">--decode</span> <span class="nt">--cookie</span> <span class="s1">'eyJlbWFpbCI6Int7Nyo3fX1AdGVzdC5jb20ifQ.YSyjmQ.1l4PRcj8FZl60I98PFQkHpyaF-E'</span>
<span class="o">{</span><span class="s1">'email'</span>: <span class="s1">'{\{7*7\}}@test.com'</span><span class="o">}</span>
</pre></table></code></div></div><p>From google search for “haproxy” for something that already known and found</p><p><img data-src="/assets/img/posts/sink/google-haroxy-search.png" alt="" data-proofer-ignore></p><h3 id="guessing-haproxy-version"><span class="mr-2">Guessing haproxy version</span><a href="#guessing-haproxy-version" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>There is HTTP Request Smuggling Vulnerability in haproxy package, versions &lt;1.8.19-1+deb10u3; <strong>Source</strong> <a href="https://snyk.io/vuln/SNYK-DEBIAN10-HAPROXY-474258">snyk Vulnerability DB</a></p><p>Vulnerability resolve in Debian:10 haproxy to version 1.8.19-1+deb10u3 or higher.</p><p>The way i verify that this Vulnerability present in this box is,</p><p>From Port 22 version header “OpenSSH 8.2p1 Ubuntu 4ubuntu0.1”, Running host version is possibly “<strong>Focal</strong>” and update date <strong>2020-06-08</strong>; <strong>Source</strong> <a href="https://launchpad.net/ubuntu/+source/openssh/1:8.2p1-4ubuntu0.1">launchpad</a></p><p>And Vulnerability resolve on <strong>2020-09-26</strong> update. <strong>Source</strong> <a href="https://launchpad.net/debian/+source/haproxy/1.8.19-1+deb10u3">launchpad</a></p><p><strong>Or, Just send a bad request to server and it will return the version number</strong></p><p><img data-src="/assets/img/posts/sink/haproxy-version.png" alt="" data-proofer-ignore></p><p>Server is running version 1.9.10 and http smuggling Vulnerability found in HAProxy before 2.0.6.</p><h1 id="foothold">Foothold</h1><h2 id="http-request-smuggling"><span class="mr-2">http Request Smuggling</span><a href="#http-request-smuggling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>“When malformed or abnormal HTTP requests are interpreted by one or more entities in the data flow between the user and the web server, such as a proxy or firewall, they can be interpreted inconsistently, allowing the attacker to “smuggle” a request to one device without the other device being aware of it.”</p><p><strong>Important terms</strong></p><ul><li><strong><code class="language-plaintext highlighter-rouge">transfer-encoding</code>:</strong> The Transfer-Encoding header specifies the form of encoding used to safely transfer the payload body to the user; <strong>Source</strong> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding">developer.mozilla.org</a><li>“chunked” value specifications.<ul><li>With <code class="language-plaintext highlighter-rouge">chunked</code> value Enable, Data is sent in a series of chunks.<li>The Content-Length header is omitted.<li>At the beginning of each chunk(data) you need to add the length of the current chunk in hexadecimal format, followed by ‘<code class="language-plaintext highlighter-rouge">\r\n</code>’ and then the chunk itself, followed by another ‘<code class="language-plaintext highlighter-rouge">\r\n</code>’.<li>The terminating chunk is a regular chunk, with the exception that its length is zero and formatted same as regular data chunks.</ul><li><a href="https://datatracker.ietf.org/doc/html/rfc2616#section-4.4">RFC2616</a></ul><p><strong>Resources for learning/understanding</strong></p><ul><li>Video: <a href="https://www.youtube.com/watch?v=dVU9i5PsMPY">Hiding Wookiees in HTTP: HTTP smuggling</a> by <a href="https://twitter.com/regilero">@regilero</a><li>Video: <a href="https://www.youtube.com/watch?v=3tpnuzFLU8g">Practical Attacks Using HTTP Request Smuggling</a> by <a href="https://twitter.com/defparam?lang=en">@defparam</a><li>Video: HTTP Desync Attacks: Smashing into the Cell Next Door by <a href="https://twitter.com/albinowax">@albinowax</a><ul><li>owasp: https://www.youtube.com/watch?v=upEMlJeU_Ik<li>defcon: https://www.youtube.com/watch?v=w-eJM2Pc0KI<li>blackhat: https://www.youtube.com/watch?v=kgkRih2MQtU<li>blackhat: https://www.youtube.com/watch?v=_A04msdplXs</ul><li>Research: <a href="https://portswigger.net/research/request-smuggling">request-smuggling</a> from portswigger<li>Blog: <a href="https://paper.seebug.org/1049/">Protocol Layer Attack - HTTP Request Smuggling</a></ul><p><strong>Tools</strong></p><ul><li><a href="https://github.com/defparam/smuggler">smuggler</a> by <a href="https://github.com/defparam">defparam</a></ul><h3 id="exploit-clte"><span class="mr-2">Exploit CL.TE</span><a href="#exploit-clte" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>CL.TE:</strong> the front-end server uses the <code class="language-plaintext highlighter-rouge">Content-Length</code> header and the back-end server uses the <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> header.</p><p><strong><a href="https://book.hacktricks.xyz/pentesting-web/http-request-smuggling">hacktricks source</a> that found from google search.</strong></p><p><strong>CVE identifier:</strong> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18277">CVE-2019-18277</a></p><p><strong>Vulnerability Description:</strong> “A flaw was found in HAProxy before 2.0.6. In legacy mode, messages featuring a transfer-encoding header missing the “chunked” value were not being correctly rejected. The impact was limited but if combined with the “http-reuse always” setting, it could be used to help construct an HTTP request smuggling attack against a vulnerable component employing a lenient parser that would ignore the content-length header as soon as it saw a transfer-encoding one (even if not entirely valid according to the specification).”</p><p><strong>And here is the <a href="https://gist.github.com/ndavison/4c69a2c164b2125cd6685b7d5a3c135b">haproxy Vulnerability PoC</a> by <a href="https://github.com/ndavison">ndavison</a></strong></p><p>When <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> and <code class="language-plaintext highlighter-rouge">Content-Length</code> is provided together, The request HAProxy sends to the backend has correctly prioritized <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code>, and has stripped out the <code class="language-plaintext highlighter-rouge">content-length</code> and cut off everything, which went outside the boundary of the <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> request (Anything after <code class="language-plaintext highlighter-rouge">0</code>).</p><p>However, if we have a <code class="language-plaintext highlighter-rouge">\x0b</code> (vertical tab) before the “chunked” string (note: <code class="language-plaintext highlighter-rouge">\x0c</code> aka form feed also works).</p><p>In this case, the <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> is not detected by HAProxy, and so the <code class="language-plaintext highlighter-rouge">Content-Length</code> is used. However, because the <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> remains in the request sent to the backend, it means that if a backend server manages to parse the <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> header and proceeds to treat the request as a TE encoded request, a desync could occur and the backend TCP socket could be poisoned. This could then lead to HTTP request smuggling.</p><p>So if the backend server allowed <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> then backend server give priority to <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code> header and terminate request at terminating chunk <code class="language-plaintext highlighter-rouge">0</code> and anything after that treated as second request.</p><ul><li>If not worked then use connection as <code class="language-plaintext highlighter-rouge">keep-alive</code></ul><p><img data-src="/assets/img/posts/sink/haproxy-http-smuggling.png" alt="" data-proofer-ignore></p><p>And you can add <code class="language-plaintext highlighter-rouge">0b</code> byte before <code class="language-plaintext highlighter-rouge">chunked</code> string from hex tab in repeater window and with <code class="language-plaintext highlighter-rouge">\n</code> switch in repeater window you can see non-printable chars</p><p><img data-src="/assets/img/posts/sink/add-hex-0b.png" alt="" data-proofer-ignore></p><p>If everything goes well, our comment contains admin session cookie</p><p><img data-src="/assets/img/posts/sink/admin-cookie.png" alt="" data-proofer-ignore></p><p>Got admin cookie because while backend server waiting to complete 300 bytes of data of our request while frontend server forward another user’s request to backend and this request concatenate to our request to complete 300 bytes.</p><p>And replacing session cookie with admin cookie ge to the admin panel</p><p><img data-src="/assets/img/posts/sink/edit-cookie.png" alt="" data-proofer-ignore></p><p>From admin’s <code class="language-plaintext highlighter-rouge">/notes</code> found 3 notes with creds and subdomains</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Chef Login : http://chef.sink.htb Username : chefadm Password : /6'fEGC&amp;zEx{4]zz 
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Dev Node URL : http://code.sink.htb Username : root Password : FaH@3L&gt;Z3})zzfQ3 
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Nagios URL : https://nagios.sink.htb Username : nagios_adm Password : g8&lt;H6GK\{*L.fB3C 
</pre></table></code></div></div><p>First i tried to login to gitea server because there is a user named “root” who has some contributions</p><p>With <code class="language-plaintext highlighter-rouge">root:FaH@3L&gt;Z3})zzfQ3</code> creds logged in successfully and found some repositories</p><p><img data-src="/assets/img/posts/sink/root-repos.png" alt="" data-proofer-ignore></p><p><strong>Some interesting Information collected from these repositories:</strong></p><ul><li><p>Got ssh key for user “marcus” from http://10.10.10.225:3000/root/Key_Management/commit/b01a6b7ed372d154ed0bc43a342a5e1203d07b1e commit in root’s “Key_Management” repository.</p><p><img data-src="/assets/img/posts/sink/user-ssh-key.png" alt="" data-proofer-ignore></p><li><p>Found some aws secret from http://10.10.10.225:3000/root/Log_Management/commit/e8d68917f2570f3695030d0ded25dc95738fb1ba commit in root’s “Log_Management” repository.</p><p><img data-src="/assets/img/posts/sink/aws-secret.png" alt="" data-proofer-ignore></p></ul><h1 id="privesc">Privesc</h1><ul><li>Get shell as user marcus and there is a another use name “david”.</ul><p>There are multiple <a href="https://containerd.io/">containerd</a> container (total 16) running same web server application.</p><p><img data-src="/assets/img/posts/sink/container-servers.png" alt="" data-proofer-ignore></p><p>This application is same, where we exploit http request smuggling in foothold.</p><p><img data-src="/assets/img/posts/sink/container-web-app.png" alt="" data-proofer-ignore></p><ul><li><p>Every container of this application is running some services that doing there parts(guessing)</p><p><img data-src="/assets/img/posts/sink/container-process.png" alt="" data-proofer-ignore></p><ul><li>Running <code class="language-plaintext highlighter-rouge">/usr/local/bin/gunicorn</code> server.<li>Running <code class="language-plaintext highlighter-rouge">/home/haproxy/haproxy</code> server.<li>Executing <code class="language-plaintext highlighter-rouge">/home/bot/bot.py</code> which give us admin token from http smuggling attack.<li>Running <code class="language-plaintext highlighter-rouge">/usr/bin/fail2ban-server</code> to prevent brute-force on web server.</ul></ul><p>There are some local services running</p><p><img data-src="/assets/img/posts/sink/local-services.png" alt="" data-proofer-ignore></p><p>Port <code class="language-plaintext highlighter-rouge">4566</code> is by defaut used by <a href="https://github.com/localstack/localstack">localstack</a></p><p>localstack running from a container on <code class="language-plaintext highlighter-rouge">172.18.0.2</code>.</p><ul><li><a href="https://localstack.cloud/">localstack</a> provides an easy-to-use test/mocking framework for developing Cloud applications. It spins up a testing environment on your local machine that provides the same functionality and APIs as the real AWS cloud environment.<li><code class="language-plaintext highlighter-rouge">awscli</code> already installed in the box.</ul><p>There is a local aws instance is running and awscli already installed in the box and we found aws secret from gitea.</p><h2 id="aws-secretsmanager"><span class="mr-2">AWS secretsmanager</span><a href="#aws-secretsmanager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Configure awscli to access localstack instance by running <code class="language-plaintext highlighter-rouge">aws configure</code></p><p><img data-src="/assets/img/posts/sink/aws-configure.png" alt="" data-proofer-ignore></p><p>Get access to aws <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html">secretsmanager</a>, aws secrets manager stores credentials.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> secretsmanager list-secrets
</pre></table></code></div></div><p><img data-src="/assets/img/posts/sink/aws-secretlist.png" alt="" data-proofer-ignore></p><p>There are 3 secret IDs(ARN), we can retrieve there secret string with; <strong>Source</strong> <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html">aws docs</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> secretsmanager get-secret-value <span class="nt">--secret-id</span> &lt;ARN&gt;
</pre></table></code></div></div><p>and get david password from <code class="language-plaintext highlighter-rouge">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-LtCKQ"</code></p><p><img data-src="/assets/img/posts/sink/david-password.png" alt="" data-proofer-ignore></p><p>There is a encrypted file in david home folder</p><p><img data-src="/assets/img/posts/sink/enc-file.png" alt="" data-proofer-ignore></p><h2 id="aws-kms-decrypt"><span class="mr-2">AWS kms decrypt</span><a href="#aws-kms-decrypt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>From <a href="https://docs.aws.amazon.com/cli/latest/reference/kms/index.html">aws kms docs</a> found some kms command that are useful.</p><p><code class="language-plaintext highlighter-rouge">decrypt</code>: Decrypts ciphertext that was encrypted by a KMS key.</p><p><code class="language-plaintext highlighter-rouge">enable-key</code>: Sets the key state of a KMS key to enabled. This allows you to use the KMS key for cryptographic operations.</p><p><code class="language-plaintext highlighter-rouge">list-keys</code> : Gets a list of all KMS keys in the caller’s Amazon Web Services account and Region.</p><p><code class="language-plaintext highlighter-rouge">describe-key</code>: Provides detailed information about a KMS key.</p><p>Get kms key from aws server</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms list-keys
</pre></table></code></div></div><p><img data-src="/assets/img/posts/sink/awskms-keys.png" alt="" data-proofer-ignore></p><p>Now to can decrypt that file with decrypt command</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms decrypt <span class="se">\</span>
    <span class="nt">--ciphertext-blob</span> fileb:///home/david/Projects/Prod_Deployment/servers.enc <span class="se">\</span>
    <span class="nt">--key-id</span> &lt;KeyId&gt; <span class="se">\</span>
    <span class="nt">--output</span> text <span class="se">\</span>
    <span class="nt">--query</span> Plaintext | <span class="nb">base64</span>
</pre></table></code></div></div><p>but when run this command, get key is disabled error.</p><p><img data-src="/assets/img/posts/sink/key-disabled.png" alt="" data-proofer-ignore></p><p>First we need to enable all key with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms enable-key <span class="nt">--key-id</span> &lt;KeyId&gt;
</pre></table></code></div></div><p>Second, This file is not encrypted with default encryption algorithm. We can check this by describing ‘KeyArn”</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms describe-key <span class="nt">--key-id</span> <span class="s2">"&lt;KeyArn&gt;"</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/sink/enc-algo.png" alt="" data-proofer-ignore></p><p>Final decryption script</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">keys</span><span class="o">=</span><span class="si">$(</span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms list-keys | <span class="nb">grep </span>KeyId | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'"'</span> <span class="nt">-f4</span><span class="si">)</span>

<span class="k">for </span>key <span class="k">in</span> <span class="nv">$keys</span><span class="p">;</span>
<span class="k">do
	</span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms enable-key <span class="nt">--key-id</span> <span class="s2">"</span><span class="nv">$key</span><span class="s2">"</span>
	aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms decrypt <span class="se">\</span>
	    <span class="nt">--ciphertext-blob</span> fileb:///home/david/Projects/Prod_Deployment/servers.enc <span class="se">\</span>
	    <span class="nt">--encryption-algorithm</span> <span class="s2">"RSAES_OAEP_SHA_256"</span> <span class="se">\</span>
	    <span class="nt">--key-id</span> <span class="s2">"</span><span class="nv">$key</span><span class="s2">"</span> <span class="se">\</span>
	    <span class="nt">--output</span> text <span class="se">\</span>
	    <span class="nt">--query</span> Plaintext | <span class="nb">base64
</span><span class="k">done</span>
</pre></table></code></div></div><p>And file decrypted with <code class="language-plaintext highlighter-rouge">804125db-bdf1-465a-a058-07fc87c0fad0</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms decrypt <span class="se">\</span>
    <span class="nt">--ciphertext-blob</span> fileb:///home/david/Projects/Prod_Deployment/servers.enc <span class="se">\</span>
    <span class="nt">--encryption-algorithm</span> <span class="s2">"RSAES_OAEP_SHA_256"</span> <span class="se">\</span>
    <span class="nt">--key-id</span> 804125db-bdf1-465a-a058-07fc87c0fad0 <span class="se">\</span>
    <span class="nt">--output</span> text <span class="se">\</span>
    <span class="nt">--query</span> Plaintext | <span class="nb">base64</span> <span class="se">\</span>
    <span class="nt">--decode</span> <span class="o">&gt;</span> decrypted-file
</pre></table></code></div></div><p><img data-src="/assets/img/posts/sink/file-decrypted.png" alt="" data-proofer-ignore></p><p>Got an admin password which worked for root user.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a>, <a href='/categories/linux/'>linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/haproxy-1-9-10/" class="post-tag no-text-decoration" >haproxy 1.9.10</a> <a href="/tags/http-request-smuggling/" class="post-tag no-text-decoration" >http request smuggling</a> <a href="/tags/localstack/" class="post-tag no-text-decoration" >localstack</a> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/awscli/" class="post-tag no-text-decoration" >awscli</a> <a href="/tags/aws-secretsmanager/" class="post-tag no-text-decoration" >aws secretsmanager</a> <a href="/tags/aws-kms-decrypt/" class="post-tag no-text-decoration" >aws kms decrypt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox - Sink - Poorduck&amp;url=https://x00tex.github.io/posts/sink/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox - Sink - Poorduck&amp;u=https://x00tex.github.io/posts/sink/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://x00tex.github.io/posts/sink/&amp;text=Hackthebox - Sink - Poorduck" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/meta/">Hackthebox - Meta</a><li><a href="/posts/pandora/">Hackthebox - Pandora</a><li><a href="/posts/writer/">Hackthebox - Writer</a><li><a href="/posts/blunder/">Hackthebox - Blunder</a><li><a href="/posts/luanne/">Hackthebox - Luanne</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">command injection</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/file-upload/">file-upload</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/ssti/">ssti</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/awscli/">awscli</a> <a class="post-tag" href="/tags/dns/">dns</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bucket/"><div class="card-body"> <em class="timeago small" data-ts="1603132200" > 2020-10-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Bucket</h3><div class="text-muted small"><p> Scanning Nmap ports=$(nmap -Pn -p- --min-rate=1000 -T4 10.10.10.193 | grep open | awk -F / &#39;{print $1}&#39; ORS=&#39;,&#39;) echo $ports &amp;amp;&amp;amp; nmap -p$ports -sV -sC -v -T4 -oA scans/nmap.full 10...</p></div></div></a></div><div class="card"> <a href="/posts/unicode/"><div class="card-body"> <em class="timeago small" data-ts="1638383400" > 2021-12-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Unicode</h3><div class="text-muted small"><p> Enumeration IP-ADDR: 10.10.11.126 hackmedia.htb nmap scan: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux...</p></div></div></a></div><div class="card"> <a href="/posts/pikaboo/"><div class="card-body"> <em class="timeago small" data-ts="1639161000" > 2021-12-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Pikaboo</h3><div class="text-muted small"><p> Enumeration IP-ADDR: 10.10.10.249 pikaboo.htb nmap scan: 1 2 3 4 5 6 7 8 9 10 11 PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.9p1 Debian 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/unobtainium/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox - Unobtainium</p></a> <a href="/posts/forge/" class="btn btn-outline-primary" prompt="Newer"><p>Hackthebox - Forge</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/p00rduck">p00rduck</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">command injection</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/file-upload/">file-upload</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/ssti/">ssti</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/awscli/">awscli</a> <a class="post-tag" href="/tags/dns/">dns</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
